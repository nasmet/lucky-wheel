var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.createTemplateTagFirstArg=function(a){return a.raw=a};$jscomp.createTemplateTagFirstArgWithRaw=function(a,l){a.raw=l;return a};
jQuery(document).ready(function(a){function l(){var e=luckyWheelData.prizes,b=0,c=0;e.forEach(function(f){"custom"===f.type&&f.image_url&&c++});if(0!==c){var h=luckyWheelData.settings;h.wheel_background&&(d.wheelImage=new Image,d.wheelImage.src=h.wheel_background,c++,d.wheelImage.onload=function(){b++;b===c&&d.draw()});h.wheel_pointer&&(d.pointerImg=new Image,d.pointerImg.src=h.wheel_pointer,c++,d.pointerImg.onload=function(){b++;b===c&&d.draw()});e.forEach(function(f,k){"custom"===f.type&&f.image_url&&
(d.segments[k+1].imgData=new Image,d.segments[k+1].imgData.src=f.image_url,d.segments[k+1].imgData.onload=function(){b++;b===c&&d.draw()})})}}function p(){m=!1;g&&("no"===g.prizeType?a("#result-title").text("Paws and reflect! Better luck next spin!"):(a("#result-title").text("Winner winner! Your prize is locked in! \ud83c\udfaf "),"coupon"===g.prizeType?(a("#result-message").text("Your coupon code: "+g.couponCode),a("#result-image-container").html("<p>"+g.prizeName+"</p>")):(a("#result-message").text("(Valid for 24 hours - complete your order now!)"),
g.imageUrl&&a("#result-image-container").html('<img src="'+g.imageUrl+'" alt="Prize pictures">\n            <p style=\'transform: translateY(-50px);color: #333;font-weight: bold;\'>'+g.prizeName+"</p>\n            "))),a("#lucky-wheel-result").fadeIn(300),a("#lucky-wheel-start").prop("disabled",!0).text("Participated"))}var d,m=!1,g=null;(function(){for(var e=luckyWheelData.prizes,b=luckyWheelData.settings,c=e.length,h=[],f=0;f<c;f++){var k=e[f],n={text:k.name,textFillStyle:"black"};k.image_url&&
(n.image=k.image_url,n.textFillStyle="white");h.push(n)}d=new Winwheel({canvasId:"lucky-wheel-canvas",numSegments:c,sliceImageScaleFactor:b.slice_image_scale_factor||1,outerRadius:b.outer_radius,rotationAngle:0,wheelImage:"",pointerGuide:{display:!0},pointerImg:"",pointerBottomHeight:b.pointer_bottom_height,strokeStyle:b.slice_line_color||"grey",lineWidth:1,drawText:!0,textFontSize:16,textAlignment:"center",textOrientation:"horizontal",textMargin:15,textFontFamily:"Arimo",drawMode:"segmentImage",
segments:h,imageOverlay:!0,animation:{type:"spinToStop",duration:5,spins:8,callbackFinished:p}});l()})();a("#lucky-wheel-start").click(function(){if(!m){var e=a("#lucky-wheel-email").val();e?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)?a.ajax({url:luckyWheelData.ajaxUrl,type:"POST",dataType:"json",data:{action:"lucky_wheel_spin",email:e,prize_attr:luckyWheelData.prize_attr,nonce:luckyWheelData.nonce},beforeSend:function(){a("#lucky-wheel-start").prop("disabled",!0).text("Drawing...")},success:function(b){if(b.success){g=
b.data;var c=luckyWheelData.prizes;b=parseInt(g.prizeIndex);c=360/c.length;d.animation.stopAngle=(b*c+Math.floor(Math.random()*(c-20)+10))%360;d.startAnimation();m=!0}else alert(b.data.message),a("#lucky-wheel-start").prop("disabled",!1).text("Start lucky draw")},error:function(){alert("Network error, please try again later");a("#lucky-wheel-start").prop("disabled",!1).text("Start lucky draw")}}):alert("Please enter a valid email address"):alert("Please enter your email address")}});a("#lucky-wheel-close").click(function(){a("#lucky-wheel-result").fadeOut(300)});
a("#lucky-wheel-result").click(function(e){e.target===this&&a(this).fadeOut(300)})});